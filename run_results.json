{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2024-01-06T15:15:42.853233Z", "invocation_id": "d5243293-d207-40c2-9a30-5cff23bc27b0", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-06T15:15:42.785074Z", "completed_at": "2024-01-06T15:15:42.795032Z"}, {"name": "execute", "started_at": "2024-01-06T15:15:42.796754Z", "completed_at": "2024-01-06T15:15:42.796779Z"}], "thread_id": "Thread-2", "execution_time": 0.021182775497436523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_deel_case.stg_chargeback_report", "compiled": true, "compiled_code": "\n\nWITH\n\nraw_table as ( SELECT * FROM `dev-jgarcia-deel-case`.`globepay`.`chargeback_report` )\n\n, final as (\n\n    SELECT\n        external_ref\n        , CAST(status as BOOL) as status\n        , source\n        , CAST(chargeback as BOOL) as chargeback\n    FROM\n        raw_table\n\n)\n\nSELECT * FROM final", "relation_name": "`dev-jgarcia-deel-case`.`globepay`.`stg_chargeback_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-06T15:15:42.778702Z", "completed_at": "2024-01-06T15:15:42.795536Z"}, {"name": "execute", "started_at": "2024-01-06T15:15:42.797203Z", "completed_at": "2024-01-06T15:15:42.797207Z"}], "thread_id": "Thread-1", "execution_time": 0.02313971519470215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_deel_case.stg_acceptance_report", "compiled": true, "compiled_code": "\n\nWITH\n\nraw_table as ( SELECT * FROM `dev-jgarcia-deel-case`.`globepay`.`acceptance_report` )\n\n, final as (\n\n    SELECT\n        external_ref\n        , CAST(status as BOOL) as status\n        , source\n        , ref\n        , DATETIME(PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%E*S%Ez', date_time)) as date_time\n        , state\n        , CAST(cvv_provided as BOOL) as cvv_provided\n        , CAST(amount as FLOAT64) as amount\n        , country\n        , currency\n        , PARSE_JSON(rates, wide_number_mode=>'round') as rates\n    FROM\n        raw_table\n\n)\n\nSELECT * FROM final", "relation_name": "`dev-jgarcia-deel-case`.`globepay`.`stg_acceptance_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-06T15:15:42.803733Z", "completed_at": "2024-01-06T15:15:42.824294Z"}, {"name": "execute", "started_at": "2024-01-06T15:15:42.825598Z", "completed_at": "2024-01-06T15:15:42.825604Z"}], "thread_id": "Thread-4", "execution_time": 0.02634286880493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_deel_case.mrt_transactions", "compiled": true, "compiled_code": "\n\nWITH\n\nacceptance_report as ( SELECT * FROM `dev-jgarcia-deel-case`.`globepay`.`stg_acceptance_report` )\n\n, chargeback_report as ( SELECT * FROM `dev-jgarcia-deel-case`.`globepay`.`stg_chargeback_report` )\n\n, final as (\n\n    SELECT\n        ar.external_ref\n        , ar.status\n        , ar.source\n        , ar.ref\n        , ar.date_time\n        , ar.state\n        , cr.chargeback\n        , ar.cvv_provided\n        , ar.country\n        , ar.currency\n        , ar.amount as amount_local_currency\n        , ar.amount / FLOAT64(ar.rates[ar.currency]) as amount_usd\n    FROM\n        acceptance_report as ar\n    LEFT JOIN\n        chargeback_report as cr\n        USING (external_ref)\n\n)\n\nSELECT * FROM final", "relation_name": "`dev-jgarcia-deel-case`.`globepay`.`mrt_transactions`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-06T15:15:42.808592Z", "completed_at": "2024-01-06T15:15:42.824675Z"}, {"name": "execute", "started_at": "2024-01-06T15:15:42.825921Z", "completed_at": "2024-01-06T15:15:42.825925Z"}], "thread_id": "Thread-2", "execution_time": 0.02457284927368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_deel_case.unique_stg_acceptance_report_ref.6b78ffc93c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select ref as unique_field\n  from `dev-jgarcia-deel-case`.`globepay`.`stg_acceptance_report`\n  where ref is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-06T15:15:42.807064Z", "completed_at": "2024-01-06T15:15:42.826226Z"}, {"name": "execute", "started_at": "2024-01-06T15:15:42.828998Z", "completed_at": "2024-01-06T15:15:42.829002Z"}], "thread_id": "Thread-3", "execution_time": 0.029160022735595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_deel_case.not_null_stg_acceptance_report_ref.0f3bed660a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ref\nfrom `dev-jgarcia-deel-case`.`globepay`.`stg_acceptance_report`\nwhere ref is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-06T15:15:42.834449Z", "completed_at": "2024-01-06T15:15:42.841799Z"}, {"name": "execute", "started_at": "2024-01-06T15:15:42.843542Z", "completed_at": "2024-01-06T15:15:42.843546Z"}], "thread_id": "Thread-1", "execution_time": 0.01499176025390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_deel_case.daily_acceptance_rate", "compiled": true, "compiled_code": "WITH\n\ntransactions as ( SELECT * FROM `dev-jgarcia-deel-case`.`globepay`.`mrt_transactions` )\n\nSELECT\n    DATE(date_time) as date\n    , COUNTIF(state = 'ACCEPTED') / COUNT(*) as acceptance_rate\nFROM\n    transactions\nGROUP BY 1\nORDER BY 1 ASC", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-06T15:15:42.832190Z", "completed_at": "2024-01-06T15:15:42.842093Z"}, {"name": "execute", "started_at": "2024-01-06T15:15:42.843800Z", "completed_at": "2024-01-06T15:15:42.843802Z"}], "thread_id": "Thread-2", "execution_time": 0.015966176986694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_deel_case.countries_declined_over_25m", "compiled": true, "compiled_code": "WITH\n\ntransactions as ( SELECT * FROM `dev-jgarcia-deel-case`.`globepay`.`mrt_transactions` )\n\nSELECT\n    country\n    , SUM(IF(state = \"DECLINED\", amount_usd, 0)) as amount_usd\nFROM\n    transactions\nGROUP BY 1\nHAVING amount_usd > 25000000\nORDER BY 2 DESC", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-06T15:15:42.836242Z", "completed_at": "2024-01-06T15:15:42.842352Z"}, {"name": "execute", "started_at": "2024-01-06T15:15:42.844275Z", "completed_at": "2024-01-06T15:15:42.844279Z"}], "thread_id": "Thread-4", "execution_time": 0.015853166580200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_deel_case.missing_chargeback_data", "compiled": true, "compiled_code": "WITH\n\ntransactions as ( SELECT * FROM `dev-jgarcia-deel-case`.`globepay`.`mrt_transactions` )\n\nSELECT\n    *\nFROM\n    transactions\nWHERE chargeback IS NULL", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-06T15:15:42.838822Z", "completed_at": "2024-01-06T15:15:42.843068Z"}, {"name": "execute", "started_at": "2024-01-06T15:15:42.845590Z", "completed_at": "2024-01-06T15:15:42.845593Z"}], "thread_id": "Thread-3", "execution_time": 0.008857965469360352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_deel_case.not_null_mrt_transactions_external_ref.c487baad95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect external_ref\nfrom `dev-jgarcia-deel-case`.`globepay`.`mrt_transactions`\nwhere external_ref is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-06T15:15:42.847887Z", "completed_at": "2024-01-06T15:15:42.850770Z"}, {"name": "execute", "started_at": "2024-01-06T15:15:42.851250Z", "completed_at": "2024-01-06T15:15:42.851254Z"}], "thread_id": "Thread-1", "execution_time": 0.004447221755981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_deel_case.unique_mrt_transactions_external_ref.5441445e55", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select external_ref as unique_field\n  from `dev-jgarcia-deel-case`.`globepay`.`mrt_transactions`\n  where external_ref is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 0.8262939453125, "args": {"which": "generate", "static_parser": true, "show_resource_report": false, "log_path": "/Users/juliano.garcioa/Documents/deel/dbt-deel-case/logs", "log_level": "info", "project_dir": "/Users/juliano.garcioa/Documents/deel/dbt-deel-case", "write_json": true, "cache_selected_only": false, "printer_width": 80, "print": true, "introspect": true, "partial_parse": true, "select": [], "profiles_dir": "/Users/juliano.garcioa/.dbt", "invocation_command": "dbt docs generate", "use_colors": true, "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "compile": true, "version_check": true, "empty_catalog": false, "quiet": false, "log_file_max_bytes": 10485760, "exclude": [], "strict_mode": false, "static": false, "macro_debugging": false, "defer": false, "log_format": "default", "partial_parse_file_diff": true, "indirect_selection": "eager", "vars": {}, "log_format_file": "debug", "populate_cache": true, "send_anonymous_usage_stats": true, "enable_legacy_logger": false, "favor_state": false}}